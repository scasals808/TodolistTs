(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{105:function(e,t,a){e.exports=a(138)},110:function(e,t,a){},111:function(e,t,a){},138:function(e,t,a){"use strict";a.r(t);var n,o,i=a(0),r=a.n(i),l=a(8),c=a.n(l),s=(a(110),a(111),a(182)),d=a(183),u=a(184),m=a(175),f=a(140),p=a(178),b=a(186),g=a(187),v=a(185),E=a(33),h=a(83),C=a.n(h).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.1/",headers:{"API-KEY":"57a3ed4f-7ca3-4751-9d13-0519a395e3f1"}}),k=function(){return C.get("todo-lists")},j=function(e){return C.post("todo-lists",{title:e})},y=function(e){return C.delete("todo-lists/".concat(e))},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return C.put("todo-lists/".concat(e),{title:t})},T=function(e){return C.get("todo-lists/".concat(e,"/tasks"))},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"new task";return C.post("todo-lists/".concat(e,"/tasks"),{title:t})},A=function(e,t){return C.delete("todo-lists/".concat(e,"/tasks/").concat(t))},w=function(e,t,a){return C.put("todo-lists/".concat(e,"/tasks/").concat(t),a)},L=function(e){return C.post("/auth/login",e)},S=function(){return C.get("/auth/me")},x=function(){return C.delete("/auth/login")};!function(e){e[e.New=0]="New",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Draft=3]="Draft"}(n||(n={})),function(e){e[e.Low=0]="Low",e[e.Middle=1]="Middle",e[e.Hi=2]="Hi",e[e.Urgently=3]="Urgently",e[e.Later=4]="Later"}(o||(o={}));var F=function(e,t){e.messages.length?t(B({error:e.messages[0]})):t(B({error:"Some error occurred"})),t(H({status:"failed"}))},N=function(e,t){t(B({error:e.message?e.message:"Some error occurred"})),t(H({status:"failed"}))},P=a(29),z=Object(P.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(e,t){e.isLoggedIn=t.payload.value}}}),D=z.reducer,R=z.actions.setIsLoggedInAC,M=Object(P.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppErrorAC:function(e,t){e.error=t.payload.error},setAppStatusAC:function(e,t){e.status=t.payload.status},setAppInitializedAC:function(e,t){e.isInitialized=t.payload.isInitialized}}}),U=M.reducer,q=M.actions,B=q.setAppErrorAC,H=q.setAppStatusAC,Z=q.setAppInitializedAC,_=Object(P.b)({name:"todolists",initialState:[],reducers:{removeTodoListAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));a>-1&&e.splice(a,1)},addTodoListAC:function(e,t){e.unshift(Object(E.a)(Object(E.a)({},t.payload.todo),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].title=t.payload.title},changeTodolistFilterAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].filter=t.payload.filter},setTodoListsAC:function(e,t){return t.payload.todoLists.map((function(e){return Object(E.a)(Object(E.a)({},e),{},{filter:"all",entityStatus:"idle"})}))},changeTodolistEntityStatusAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].entityStatus=t.payload.status}}}),J=_.reducer,K=_.actions,W=K.removeTodoListAC,$=K.addTodoListAC,G=K.changeTodolistTitleAC,V=K.changeTodolistFilterAC,Y=K.setTodoListsAC,Q=K.changeTodolistEntityStatusAC,X=a(17),ee=a(179),te=a(139),ae=a(48),ne=a(188),oe=a(176),ie=r.a.memo((function(e){var t=e.addItem,a=e.disabled,n=void 0!==a&&a,o=e.todoId,l=Object(i.useState)(""),c=Object(ae.a)(l,2),s=c[0],d=c[1],u=Object(i.useState)(null),f=Object(ae.a)(u,2),p=f[0],b=f[1];function g(){""!==s.trim()?(t(s.trim(),o),d("")):b("Title is required!")}return r.a.createElement("div",null,r.a.createElement(ne.a,{size:"small",disabled:n,variant:"outlined",value:s,onChange:function(e){d(e.currentTarget.value),b(null)},onKeyPress:function(e){null!==p&&b(null),"Enter"===e.key&&g()},error:!!p,label:"Title",helperText:p}),r.a.createElement(m.a,{color:"primary",onClick:g,disabled:n},r.a.createElement(oe.a,null)))})),re=a(94),le=r.a.memo((function(e){console.log("span");var t=Object(i.useState)(!1),a=Object(ae.a)(t,2),n=a[0],o=a[1],l=Object(i.useState)(e.title),c=Object(ae.a)(l,2),s=c[0],d=c[1];return n?r.a.createElement(ne.a,{variant:"outlined",value:s,onBlur:function(){o(!1),e.saveNewTitle(s)},autoFocus:!0,onChange:function(e){d(e.currentTarget.value)}}):r.a.createElement("span",{onDoubleClick:function(){o(!0),d(e.title)}},e.title)})),ce=a(177),se=Object(P.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(e,t){var a=e[t.payload.todoId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&a.splice(n,1)},addTaskAC:function(e,t){e[t.payload.todoListId].unshift(t.payload)},updateTaskAC:function(e,t){var a=e[t.payload.todoId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&(a[n]=Object(E.a)(Object(E.a)({},a[n]),t.payload.model))},setTaskAC:function(e,t){e[t.payload.todoId]=t.payload.tasks}},extraReducers:function(e){e.addCase($,(function(e,t){e[t.payload.todo.id]=[]})),e.addCase(W,(function(e,t){delete e[t.payload.id]})),e.addCase(Y,(function(e,t){t.payload.todoLists.forEach((function(t){e[t.id]=[]}))}))}}),de=se.reducer,ue=se.actions,me=ue.removeTaskAC,fe=ue.addTaskAC,pe=ue.updateTaskAC,be=ue.setTaskAC,ge=function(e,t,a){return function(n,o){var i=o().tasks[e].find((function(e){return e.id===a}));if(i){var r=Object(E.a)({title:i.title,startDate:i.startDate,priority:i.priority,description:i.description,deadline:i.deadline,status:i.status},t);w(e,a,r).then((function(o){0===o.data.resultCode?n(pe({taskId:a,model:t,todoId:e})):F(o.data,n)})).catch((function(e){N(e,n)}))}else console.warn("task not found in the state")}},ve=a(190),Ee=a(89),he=a.n(Ee),Ce=r.a.memo((function(e){var t=e.task,a=t.id,o=t.title,l=t.status,c=t.todoListId,s=Object(i.useCallback)((function(t){e.changeTaskTitle(a,t,c)}),[e,a]);return r.a.createElement("div",{key:a,className:l===n.Completed?"is_done":""},r.a.createElement(ve.a,{color:"primary",checked:l===n.Completed,onChange:function(t){return e.changeStatus(a,t.currentTarget.checked?n.Completed:n.New,c)}}),r.a.createElement(le,{title:o,saveNewTitle:s}),r.a.createElement(m.a,{onClick:function(){return e.removeTask(c,a)}},r.a.createElement(he.a,null)))})),ke=r.a.memo((function(e){var t=e.demo,a=void 0!==t&&t,o=Object(re.a)(e,["demo"]);Object(i.useEffect)((function(){var e;a||c((e=o.todolist.id,function(t){t(H({status:"loading"})),T(e).then((function(a){var n=a.data.items;t(be({tasks:n,todoId:e})),t(H({status:"succeeded"}))}))}))}),[]);var l=Object(X.c)((function(e){return e.tasks[o.todolist.id]})),c=Object(X.b)(),s=l,d=s;"active"===o.todolist.filter&&(d=s.filter((function(e){return e.status===n.New}))),"completed"===o.todolist.filter&&(d=s.filter((function(e){return e.status===n.Completed})));var u=Object(i.useCallback)((function(){return o.changeTodolistFilter(o.todolist.id,"all")}),[o]),f=Object(i.useCallback)((function(){return o.changeTodolistFilter(o.todolist.id,"active")}),[o]),b=Object(i.useCallback)((function(){return o.changeTodolistFilter(o.todolist.id,"completed")}),[o]);var g=Object(i.useCallback)((function(e,t){c(function(e,t){return function(a){a(H({status:"loading"})),A(e,t).then((function(){a(me({taskId:t,todoId:e})),a(H({status:"succeeded"}))}))}}(e,t))}),[]),v=Object(i.useCallback)((function(e){o.changeTodoListTitle(o.todolist.id,e)}),[o]),E=Object(i.useCallback)((function(e,t){c(function(e,t){return function(a){a(H({status:"loading"})),I(e,t).then((function(e){0===e.data.resultCode?(a(fe(e.data.data.item)),a(H({status:"succeeded"}))):F(e.data,a)})).catch((function(e){N(e,a)}))}}(t,e))}),[]),h=Object(i.useCallback)((function(e,t,a){c(ge(a,{status:t},e))}),[]),C=Object(i.useCallback)((function(e,t,a){c(ge(a,{title:t},e))}),[]);return r.a.createElement("div",null,r.a.createElement("h3",null,r.a.createElement(le,{title:o.todolist.title,saveNewTitle:v}),r.a.createElement(m.a,{onClick:function(){o.removeTodoList(o.todolist.id)},disabled:"loading"===o.todolist.entityStatus},r.a.createElement(ce.a,null))),r.a.createElement(ie,{addItem:E,todoId:o.todolist.id,disabled:"loading"===o.todolist.entityStatus}),r.a.createElement("div",null,d.map((function(e,t){return r.a.createElement(Ce,{key:t,task:e,removeTask:g,changeStatus:h,changeTaskTitle:C})}))),r.a.createElement("div",null,r.a.createElement(p.a,{variant:"all"===o.todolist.filter?"contained":"outlined",color:"all"===o.todolist.filter?"default":"primary",onClick:u},"All"),r.a.createElement(p.a,{variant:"active"===o.todolist.filter?"contained":"outlined",color:"active"===o.todolist.filter?"default":"primary",onClick:f},"Active"),r.a.createElement(p.a,{variant:"completed"===o.todolist.filter?"contained":"outlined",color:"completed"===o.todolist.filter?"default":"primary",onClick:b},"Completed")))})),je=a(14),ye=function(e){var t=e.demo,a=void 0!==t&&t,n=Object(X.b)(),o=Object(X.c)((function(e){return e.todoLists})),l=Object(X.c)((function(e){return e.auth.isLoggedIn}));Object(i.useEffect)((function(){!a&&l&&n((function(e){e(H({status:"loading"})),k().then((function(t){var a=t.data;e(Y({todoLists:a})),e(H({status:"succeeded"}))}))}))}),[]);var c=Object(i.useCallback)((function(e,t){var a,o;n((a=e,o=t,function(e){e(H({status:"loading"})),O(a,o).then((function(){e(G({id:a,title:o})),e(H({status:"succeeded"}))}))}))}),[]),s=Object(i.useCallback)((function(e,t){n(V({id:e,filter:t}))}),[n]),d=Object(i.useCallback)((function(e){var t;n((t=e,function(e){e(H({status:"loading"})),e(Q({id:t,status:"loading"})),y(t).then((function(){e(W({id:t})),e(H({status:"succeeded"}))}))}))}),[]),u=Object(i.useCallback)((function(e){var t;n((t=e,function(e){e(H({status:"loading"})),j(t).then((function(t){0===t.data.resultCode?(e($({todo:t.data.data.item})),e(H({status:"succeeded"}))):F(t.data,e)})).catch((function(t){N(t,e)}))}))}),[]);return l?r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.a,{container:!0,style:{padding:"20px"}},r.a.createElement(ie,{addItem:u,todoId:""})),r.a.createElement(ee.a,{container:!0,spacing:5},o.map((function(e,t){return r.a.createElement(ee.a,{item:!0,key:t},r.a.createElement(te.a,{style:{padding:"20px"},elevation:6},r.a.createElement(ke,{todolist:e,key:e.id,changeTodolistFilter:s,changeTodoListTitle:c,removeTodoList:d,demo:a})))})))):r.a.createElement(je.a,{to:"/login"})},Oe=a(192),Te=a(189);function Ie(e){return r.a.createElement(Te.a,Object.assign({elevation:6,variant:"filled"},e))}function Ae(){var e=Object(X.c)((function(e){return e.app.error})),t=Object(X.b)(),a=function(e,a){"clickaway"!==a&&t(B({error:null}))},n=null!==e;return r.a.createElement(Oe.a,{open:n,autoHideDuration:3e3,onClose:a},r.a.createElement(Ie,{onClose:a,severity:"error"},e))}var we=a(173),Le=a(174),Se=a(180),xe=a(181),Fe=a(93),Ne=function(){var e=Object(X.b)(),t=Object(X.c)((function(e){return e.auth.isLoggedIn})),a=Object(Fe.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<3&&(t.password="Invalid password"):t.password="Required",t},onSubmit:function(t){var a;e((a=t,function(e){e(H({status:"loading"})),L(a).then((function(t){0===t.data.resultCode?(e(R({value:!0})),e(H({status:"succeeded"}))):F(t.data,e)})).catch((function(t){N(t,e)}))}))}});return t?r.a.createElement(je.a,{to:"/"}):r.a.createElement(ee.a,{container:!0,justify:"center"},r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement(we.a,null,r.a.createElement(Le.a,null,r.a.createElement("p",null,"To log in get registered",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},"here")),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("p",null,"Email: free@samuraijs.com"),r.a.createElement("p",null,"Password: free")),r.a.createElement(Se.a,null,r.a.createElement(ne.a,Object.assign({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.errors.email?r.a.createElement("div",{style:{color:"red"}},a.errors.email):null,r.a.createElement(ne.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.errors.password?r.a.createElement("div",{style:{color:"red"}},a.errors.password):null,r.a.createElement(xe.a,{label:"Remember me",control:r.a.createElement(ve.a,a.getFieldProps("rememberMe"))}),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))};var Pe=function(e){var t=e.demo,a=void 0!==t&&t,n=Object(X.c)((function(e){return e.app.status})),o=Object(X.c)((function(e){return e.app.isInitialized})),l=Object(X.c)((function(e){return e.auth.isLoggedIn})),c=Object(X.b)();Object(i.useEffect)((function(){a||c((function(e){S().then((function(t){0===t.data.resultCode&&e(R({value:!0})),e(Z({isInitialized:!0}))}))}))}),[]);var E=Object(i.useCallback)((function(){c((function(e){e(H({status:"loading"})),x().then((function(t){0===t.data.resultCode?(e(R({value:!1})),e(H({status:"succeeded"}))):F(t.data,e)})).catch((function(t){N(t,e)}))}))}),[]);return o?r.a.createElement("div",{className:"App"},r.a.createElement(Ae,null),r.a.createElement(d.a,{position:"static"},r.a.createElement(u.a,null,r.a.createElement(m.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(v.a,null)),r.a.createElement(f.a,{variant:"h6"},"News"),l&&r.a.createElement(p.a,{color:"inherit",onClick:E},"Log out")),"loading"===n&&r.a.createElement(b.a,null)),r.a.createElement(g.a,{fixed:!0},r.a.createElement(je.d,null,r.a.createElement(je.b,{exact:!0,path:"/",render:function(){return r.a.createElement(ye,{demo:a})}}),r.a.createElement(je.b,{path:"/login",render:function(){return r.a.createElement(Ne,null)}}),r.a.createElement(je.b,{path:"/404",render:function(){return r.a.createElement("h1",null,"404: PAGE NOT FOUND")}}),r.a.createElement(je.a,{from:"*",to:"/404"})))):r.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},r.a.createElement(s.a,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ze=a(23),De=a(92),Re=a.n(De),Me=a(50),Ue=Object(ze.c)({todoLists:J,tasks:de,app:U,auth:D}),qe=Object(P.a)({reducer:Ue,middleware:function(e){return e().prepend(Me.a).concat(Re.a)}});window.store=qe;var Be=a(49);c.a.render(r.a.createElement(X.a,{store:qe},r.a.createElement(Be.a,null,r.a.createElement(Pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[105,1,2]]]);
//# sourceMappingURL=main.8cb91805.chunk.js.map